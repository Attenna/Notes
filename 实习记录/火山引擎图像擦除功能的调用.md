# 火山引擎擦除功能调用指南

> 本文档介绍了如何使用火山引擎的API进行图像擦除功能，包括签名方法、SDK调用和前端实现。

---

## 📖 目录

1. [功能概述](#功能概述)
2. [API 签名方法](#api-签名方法)
3. [SDK 调用示例](#sdk-调用示例)
4. [前端实现](#前端实现)
5. [AI 环境配置](#ai-环境配置)

---

## 功能概述

火山引擎提供了图像擦除功能，支持以下两种方式：

1. **自动识别**：通过调用分割接口，识别主体或背景并进行擦除。
2. **手动选择**：用户通过涂抹选择指定区域，上传蒙版图像和原始图像进行擦除。

---

## API 签名方法

API 签名用于验证请求者身份并防止请求被篡改。推荐使用火山引擎 SDK 以简化签名过程。

### 公共参数

| 名称        | 类型     | 是否必填 | 描述                             | 示例值        |
| --------- | ------ | ---- | ------------------------------ | ---------- |
| Action    | String | 是    | 接口名称，参考API文档取值。         | CreateUser |
| Version   | String | 是    | 接口版本，参考API文档取值。         | 2018-01-01 |
| X-Expires | Int    | 否    | 签名有效时间（秒），默认900秒。      | 900        |

### 签名参数

签名参数可以放在 `Header` 或 `Query` 中。

#### Header 示例

| 名称            | 类型     | 是否必填 | 描述                                                                 | 示例值                                                                 |
| --------------- | ------ | ---- | ------------------------------------------------------------------ | ------------------------------------------------------------------- |
| X-Date          | String | 是    | 使用UTC时间，格式：`YYYYMMDD'T'HHMMSS'Z'`                          | `20201103T104027Z`                                                  |
| Authorization   | String | 是    | 签名信息，格式：`HMAC-SHA256 Credential={AccessKeyId}/{...}`        | `HMAC-SHA256 Credential=AKLT...`                                    |
| X-Security-Token| String | 否    | 临时安全凭证中的SessionToken，长期密钥无需填写。                     | `nCitKRW94N1M5aTcwQ0tTY2dpRlM0bHczaVlaekpHdnZUd253QkI2OWxQSE9N...` |

---

## SDK 调用示例

以下是使用 Python SDK 调用图像擦除功能的示例代码：

```python
from volcengine.imagex.v2.imagex_service import ImagexService

# 初始化客户端
service = ImagexService(
    region="cn-beijing",  # 服务地域
    ak="[请替换为您的Access Key]",
    sk="[请替换为您的Secret Key]"
)

# 构造请求参数
params = {
    "req_key": "i2i_inpainting",  # 固定值
    "binary_data_base64": [
        "原图Base64",  # 三通道RGB图，Base64编码
        "MaskBase64"   # 单通道灰度图，Base64编码
    ],
    "strength": 0.8,   # 控制擦除强度
    "return_url": True # 返回图片URL（可选）
}

# 调用API
response = service.img2img_inpainting(params)
print(response)
```

---

## 前端实现

前端通过HTML和JavaScript实现以下功能：

1. **鼠标追踪**：在用户按下鼠标时记录坐标。
2. **蒙版生成**：在图像区域内创建蒙版。
3. **上传图像**：将蒙版图像和原始图像上传至API。
4. **显示结果**：展示API返回的处理后图像。

---

## AI 环境配置

### Python 环境

1. 创建虚拟环境：

   ```bash
   python -m venv venv
   source venv/bin/activate  # Windows 使用 venv\Scripts\activate
   ```

2. 安装火山引擎 SDK：

   ```bash
   pip install volcengine
   ```

3. 验证安装：

   ```bash
   python -c "import volcengine; print(volcengine.__version__)"
   ```


ai 调教好了请求体，之后验证签名算法

---

*📝 最后更新：2025年7月30日*
